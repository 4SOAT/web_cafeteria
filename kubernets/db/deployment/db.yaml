apiVersion: v1
kind: Pod
metadata:
  name: db-deployment
  labels:
    app: db-deployment
spec:
  containers:
  - name: db-deployment-container
    image: mysql
    env:
    - name: MYSQL_ROOT_PASSWORD
      value:  "123456"
    - name: MYSQL_DATABASE
      value: projeto-pedidos
    - name: MYSQL_PASSWORD
      value:  "123456"
    ports:
    - containerPort: 3306
    volumeMounts:
    - name: mysql-persistent-storage
      mountPath: /var/lib/mysql
      subPath: mysql
    readinessProbe:
          exec:
            command:
            - sh
            - -c
            - exec mysql -h 127.0.0.1 -uroot -p$MYSQL_PASSWORD -e 'SELECT 1'
          initialDelaySeconds: 10
          periodSeconds: 5
    livenessProbe:
      exec:
        command:
        - sh
        - -c
        - exec mysql -h 127.0.0.1 -uroot -p$MYSQL_PASSWORD -e 'SELECT 1'
      initialDelaySeconds: 60
      periodSeconds: 10
  volumes:
  - name: mysql-persistent-storage
    hostPath:
      path: "C:/nodejs/mysql-data"
